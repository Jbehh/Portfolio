<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contacts — CRUD</title>
  <!-- Build with: npx tailwindcss@4.1.0 -i ./src/input.css -o ./src/output.css --minify -->
  <link href="./src/output.css" rel="stylesheet" />
</head>
<body class="min-h-dvh bg-gradient-to-b from-cyan-50 via-fuchsia-50 to-indigo-50 text-neutral-900 antialiased selection:bg-cyan-300/30">
  <!-- Decorative background blobs -->
  <div class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
    <div class="absolute -top-24 -left-24 h-80 w-80 rounded-full bg-cyan-300/25 blur-3xl"></div>
    <div class="absolute top-16 right-[-6rem] h-96 w-96 rounded-full bg-fuchsia-300/25 blur-3xl"></div>
    <div class="absolute bottom-[-6rem] left-1/2 h-96 w-96 -translate-x-1/2 rounded-full bg-indigo-300/25 blur-3xl"></div>
  </div>

  <!-- Header -->
  <header class="relative isolate border-b border-white/40 bg-gradient-to-r from-cyan-600 via-sky-600 to-indigo-600 text-white">
    <div class="absolute inset-0 bg-[radial-gradient(60%_50%_at_20%_0%,rgba(255,255,255,.2),transparent_60%)]"></div>
    <div class="relative mx-auto max-w-5xl px-4 py-10">
      <div class="flex items-start gap-4">
        <div class="grid size-12 place-items-center rounded-2xl bg-white/15 ring-1 ring-white/25 backdrop-blur">
          <svg class="size-6" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 12c2.761 0 5-2.239 5-5S14.761 2 12 2 7 4.239 7 7s2.239 5 5 5zm0 2c-4.418 0-8 2.239-8 5v1h16v-1c0-2.761-3.582-5-8-5z"/>
          </svg>
        </div>
        <div>
          <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Contacts</h1>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="mx-auto max-w-5xl px-4 py-8 space-y-6">
    <!-- Stats -->
    <section class="grid gap-3 sm:grid-cols-3">
      <div class="rounded-2xl bg-white/80 p-4 ring-1 ring-cyan-200 shadow-sm backdrop-blur">
        <div class="h-1 w-12 rounded-full bg-gradient-to-r from-cyan-500 to-sky-500"></div>
        <p class="mt-3 text-xs text-neutral-500">Total Contacts</p>
        <p id="statTotal" class="mt-1 text-2xl font-semibold">0</p>
      </div>
      <div class="rounded-2xl bg-white/80 p-4 ring-1 ring-fuchsia-200 shadow-sm backdrop-blur">
        <div class="h-1 w-12 rounded-full bg-gradient-to-r from-fuchsia-500 to-pink-500"></div>
        <p class="mt-3 text-xs text-neutral-500">With Email</p>
        <p id="statWithEmail" class="mt-1 text-2xl font-semibold">0</p>
      </div>
      <div class="rounded-2xl bg-white/80 p-4 ring-1 ring-indigo-200 shadow-sm backdrop-blur">
        <div class="h-1 w-12 rounded-full bg-gradient-to-r from-indigo-500 to-violet-500"></div>
        <p class="mt-3 text-xs text-neutral-500">With Phone</p>
        <p id="statWithPhone" class="mt-1 text-2xl font-semibold">0</p>
      </div>
    </section>

    <!-- Form -->
    <section class="rounded-2xl bg-white/85 p-6 shadow-sm ring-1 ring-white/50 backdrop-blur">
      <form id="contactForm" class="grid gap-4 md:grid-cols-6">
        <input type="hidden" id="cid" />
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-neutral-800">First name</label>
          <input id="first" required placeholder="Ada"
                 class="mt-1 w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-cyan-300" />
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-neutral-800">Last name</label>
          <input id="last" required placeholder="Lovelace"
                 class="mt-1 w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-fuchsia-400 focus:border-fuchsia-300" />
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-neutral-800">Company</label>
          <input id="company" placeholder="Byron Labs"
                 class="mt-1 w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-300" />
        </div>
        <div class="md:col-span-3">
          <label class="block text-sm font-medium text-neutral-800">Email</label>
          <input id="email" type="email" required placeholder="ada@example.com"
                 class="mt-1 w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-sky-400 focus:border-sky-300" />
        </div>
        <div class="md:col-span-3">
          <label class="block text-sm font-medium text-neutral-800">Phone</label>
          <input id="phone" pattern="^[+]?[\d][\d\s-]{7,}$" placeholder="+44 20 1234 5678"
                 class="mt-1 w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm shadow-sm
                        focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-violet-300" />
        </div>

        <div class="md:col-span-6 flex flex-wrap items-center gap-3">
          <button type="submit"
                  class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-cyan-600 via-sky-600 to-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:brightness-110 active:brightness-95 transition">
            <svg class="size-4" viewBox="0 0 24 24" fill="currentColor"><path d="M13 11h8v2h-8v8h-2v-8H3v-2h8V3h2z"/></svg>
            <span id="submitLabel">Add Contact</span>
          </button>
          <button id="cancel" type="reset"
                  class="hidden rounded-xl border border-neutral-300 bg-white px-4 py-2 text-sm font-semibold hover:bg-neutral-50">
            Cancel
          </button>

          <div class="ml-auto relative w-full md:w-72">
            <input id="search" placeholder="Search name, company, email…"
                   class="w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 pl-9 text-sm shadow-sm
                          focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-cyan-300" />
            <svg class="pointer-events-none absolute left-2 top-2.5 size-4 text-neutral-400" viewBox="0 0 24 24" fill="currentColor">
              <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM5 9.5C5 7 7 5 9.5 5S14 7 14 9.5 12 14 9.5 14 5 12 5 9.5z"/>
            </svg>
          </div>
        </div>
      </form>
    </section>

    <!-- Table -->
    <section class="overflow-x-auto rounded-2xl bg-white/90 ring-1 ring-white/50 backdrop-blur">
      <table class="min-w-full text-sm">
        <thead class="bg-gradient-to-r from-cyan-50 via-sky-50 to-indigo-50 text-neutral-700 ring-1 ring-white/50">
          <tr>
            <th class="px-4 py-3 text-left font-medium">Name</th>
            <th class="px-4 py-3 text-left font-medium">Company</th>
            <th class="px-4 py-3 text-left font-medium">Email</th>
            <th class="px-4 py-3 text-left font-medium">Phone</th>
            <th class="px-4 py-3 text-right font-medium">Actions</th>
          </tr>
        </thead>
        <tbody id="rows" class="divide-y divide-neutral-100"></tbody>
      </table>

      <!-- Empty state -->
      <div id="empty" class="hidden p-10 text-center text-neutral-500">
        <div class="mx-auto mb-3 grid size-10 place-items-center rounded-xl bg-gradient-to-r from-cyan-100 to-indigo-100 text-sky-700 ring-1 ring-white/60">
          <svg class="size-5" viewBox="0 0 24 24" fill="currentColor"><path d="M13 11h8v2h-8v8h-2v-8H3v-2h8V3h2z"/></svg>
        </div>
        <p class="text-sm">No contacts yet. Add your first one above.</p>
      </div>
    </section>
  </main>

  <!-- Row Template -->
  <template id="rowTpl">
    <tr class="hover:bg-gradient-to-r hover:from-cyan-50/70 hover:via-fuchsia-50/70 hover:to-indigo-50/70 transition">
      <td class="px-4 py-3">
        <div class="flex items-center gap-3">
          <div data-avatar class="grid size-9 place-items-center rounded-full text-white text-xs font-semibold ring-2 ring-white shadow"
               title="Initials"></div>
          <div>
            <div data-name class="font-medium text-neutral-900"></div>
            <div class="text-xs text-neutral-500 sm:hidden" data-company-mobile></div>
          </div>
        </div>
      </td>
      <td class="px-4 py-3 text-neutral-700">
        <span data-company></span>
      </td>
      <td class="px-4 py-3">
        <a data-email class="text-sky-700 underline underline-offset-2 hover:text-sky-600" target="_blank" rel="noreferrer"></a>
      </td>
      <td class="px-4 py-3">
        <a data-phone class="text-neutral-700 hover:underline underline-offset-2"></a>
      </td>
      <td class="px-4 py-3">
        <div class="flex justify-end gap-2">
          <button class="rounded-md border border-neutral-300 bg-white px-3 py-1.5 text-xs font-semibold hover:bg-neutral-50" data-action="edit">Edit</button>
          <button class="rounded-md bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-rose-500" data-action="delete">Delete</button>
        </div>
      </td>
    </tr>
  </template>

  <script>
    const KEY='contacts.v1';
    let contacts = JSON.parse(localStorage.getItem(KEY) || '[]');

    const form = document.getElementById('contactForm');
    const cid = document.getElementById('cid');
    const first = document.getElementById('first');
    const last = document.getElementById('last');
    const company = document.getElementById('company');
    const email = document.getElementById('email');
    const phone = document.getElementById('phone');
    const submitLabel = document.getElementById('submitLabel');
    const cancel = document.getElementById('cancel');

    const search = document.getElementById('search');
    const rows = document.getElementById('rows');
    const tpl = document.getElementById('rowTpl');
    const empty = document.getElementById('empty');

    const statTotal = document.getElementById('statTotal');
    const statWithEmail = document.getElementById('statWithEmail');
    const statWithPhone = document.getElementById('statWithPhone');

    const save = () => localStorage.setItem(KEY, JSON.stringify(contacts));
    const uid = () => crypto.randomUUID();

    function gradientForInitial(letter) {
      // Fun but subtle gradient options based on first letter
      const i = (letter?.toUpperCase().charCodeAt(0) || 65) - 65; // A=0
      const palettes = [
        'from-cyan-500 to-sky-500', 'from-fuchsia-500 to-pink-500', 'from-indigo-500 to-violet-500',
        'from-emerald-500 to-teal-500', 'from-amber-500 to-orange-500'
      ];
      return palettes[i % palettes.length];
    }

    function updateStats() {
      statTotal.textContent = contacts.length;
      statWithEmail.textContent = contacts.filter(c => c.email && c.email.includes('@')).length;
      statWithPhone.textContent = contacts.filter(c => c.phone && c.phone.trim().length > 0).length;
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (email.validity.typeMismatch) { alert('Please enter a valid email.'); return; }
      if (phone.value && !phone.checkValidity()) { alert('Please enter a valid phone number.'); return; }
      const id = cid.value || uid();
      const payload = {
        id,
        first: first.value.trim(),
        last: last.value.trim(),
        company: company.value.trim(),
        email: email.value.trim(),
        phone: phone.value.trim(),
        createdAt: contacts.find(c=>c.id===id)?.createdAt || Date.now(),
        updatedAt: Date.now(),
      };
      if (contacts.some(c=>c.id===id)) contacts = contacts.map(c=>c.id===id?payload:c); else contacts.unshift(payload);
      save(); render(); form.reset(); cid.value=''; submitLabel.textContent='Add Contact'; cancel.classList.add('hidden');
    });

    cancel.addEventListener('click', ()=>{ cid.value=''; submitLabel.textContent='Add Contact'; cancel.classList.add('hidden'); });

    rows.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-action]'); if(!btn) return; const tr = btn.closest('tr'); const id = tr.dataset.id;
      if(btn.dataset.action==='delete'){ contacts = contacts.filter(c=>c.id!==id); save(); render(); }
      if(btn.dataset.action==='edit'){
        const c = contacts.find(c=>c.id===id);
        cid.value=c.id; first.value=c.first; last.value=c.last; company.value=c.company; email.value=c.email; phone.value=c.phone;
        submitLabel.textContent='Update Contact'; cancel.classList.remove('hidden'); window.scrollTo({top:0,behavior:'smooth'});
      }
    });

    search.addEventListener('input', render);

    function render(){
      rows.innerHTML='';
      const q = search.value.trim().toLowerCase();
      const results = contacts
        .filter(c => !q || `${c.first} ${c.last}`.toLowerCase().includes(q) || (c.company||'').toLowerCase().includes(q) || (c.email||'').toLowerCase().includes(q))
        .sort((a,b)=>b.updatedAt - a.updatedAt);

      empty.classList.toggle('hidden', results.length !== 0);

      const frag = document.createDocumentFragment();
      results.forEach(c=>{
        const node = tpl.content.cloneNode(true);
        const tr = node.querySelector('tr'); tr.dataset.id=c.id;

        // Name + avatar
        const name = `${c.first} ${c.last}`.trim() || '—';
        node.querySelector('[data-name]').textContent = name;
        node.querySelectorAll('[data-company],[data-company-mobile]').forEach(el => el.textContent = c.company || '—');

        const initials = `${(c.first||'')[0]||''}${(c.last||'')[0]||''}`.toUpperCase() || '•';
        const avatar = node.querySelector('[data-avatar]');
        avatar.textContent = initials;
        avatar.classList.add('bg-gradient-to-br', ...gradientForInitial(initials[0]).split(' '));

        // Email / Phone
        const aEmail = node.querySelector('[data-email]');
        aEmail.textContent = c.email || '—';
        aEmail.href = c.email ? `mailto:${c.email}` : '#';
        if (!c.email) aEmail.classList.remove('underline');

        const aPhone = node.querySelector('[data-phone]');
        if (c.phone) {
          aPhone.textContent = c.phone;
          aPhone.href = `tel:${c.phone.replace(/\s+/g,'')}`;
        } else {
          aPhone.textContent = '—';
          aPhone.removeAttribute('href');
          aPhone.classList.remove('hover:underline');
        }

        frag.appendChild(node);
      });
      rows.appendChild(frag);
      updateStats();
    }

    render();
  </script>
</body>
</html>
